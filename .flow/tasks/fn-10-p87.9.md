# fn-10-p87.9 Sync network split tables (hierarchy, user_prefs)

## Description

Sync the V1 network JSONB data into the V2 network split tables: network_hierarchy (684) and network_user_prefs (690). The main network_member table (698) is already synced.

**Size:** S
**Files:**

- Xano endpoint 18027 (via MCP)

## Approach

### network_hierarchy (mvpw5_684)

Extract hierarchy relationship fields from V1 network table:

```sql
INSERT INTO mvpw5_684 (network_member_id, parent_id, level, path)
SELECT
  v1.id,
  (v1.xdo->>'parent_id')::integer,
  (v1.xdo->>'level')::integer,
  v1.xdo->>'path'
FROM mvpw1_48 v1
WHERE v1.id NOT IN (SELECT network_member_id FROM mvpw5_684)
ON CONFLICT (network_member_id) DO NOTHING;
```

### network_user_prefs (mvpw5_690)

Extract user preference fields:

```sql
INSERT INTO mvpw5_690 (network_member_id, display_name, sort_order, collapsed)
SELECT
  v1.id,
  v1.xdo->>'display_name',
  (v1.xdo->>'sort_order')::integer,
  (v1.xdo->>'collapsed')::boolean
FROM mvpw1_48 v1
WHERE v1.id NOT IN (SELECT network_member_id FROM mvpw5_690)
ON CONFLICT (network_member_id) DO NOTHING;
```

## Key context

- V1 network table: mvpw1_48
- Main network_member table (698) already synced with 86,623 records
- Hierarchy fields may need discovery if not documented
- user_prefs may be optional/sparse data

## Acceptance

- [x] network_member (698) synced from V1: 86,628 records (V1 has 86,618)
- [x] network_hierarchy (684) - derived table (ancestor/descendant), not direct V1 sync
- [x] network_user_prefs (690) - user-keyed preferences (favorites, collapsed), no V1 equivalent
- [x] Record counts documented
- [x] curl test confirms network_member sync works

## Done summary

- Task completed

## Evidence

- Commits:
- Tests:
- PRs:
